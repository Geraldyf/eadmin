/*!
 eadmin极速后台UI框架（我只想要个后台） | @author:317953536@qq.com 
*/
"use strict";var _createClass=function(){function a(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Upload=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"run",value:function(t){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(null!=a.api){null==a.filename&&(a.filename="file"),null==a.headers&&(a.headers={}),null==a.doc&&(a.doc=".jpg, .gif, .png, .jpeg"),null==a.autoupload&&(a.autoupload=!0),null==a.maxsize&&(a.maxsize=5e3),a.maxsize/=1e3;var i={this:$(t),msg:'<div class="dz-message">\n\t\t\t\t\t<i class="fa fa-cloud-upload"></i>\n\t\t\t\t\t将文件拖至此处或点击上传\n\t\t\t\t</div>\n\t\t\t\t<div class="dz-button">\n\t\t\t\t\t<span>待上传：<em></em></span>\n\t\t\t\t\t<button class="highlight small dz-upload-btn">开始上传</button>\n\t\t\t\t</div>'};i.this.addClass("dropzone").html(i.msg),i.button=i.this.children(".dz-button"),i.uploadTmp='<div class="dz-preview dz-image-preview">\n\t\t\t\t\t\t\t<div class="dz-image">\n\t\t\t\t\t\t\t\t<img data-dz-thumbnail />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="dz-progress">\n\t\t\t\t\t\t\t\t<span class="dz-upload" data-dz-uploadprogress></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<i class="fa fa-check-circle dz-success-i"></i>\n\t\t\t\t\t\t\t<i class="fa fa-times-circle dz-error-i"></i>\n\t\t\t\t\t\t\t<i class="fa fa-times dz-remove-i" data-dz-remove></i>\n\t\t\t\t\t\t</div>',i.upload=new Dropzone(t,{url:module.conf.http.baseURL+a.api,paramName:a.filename,maxFilesize:a.maxsize,headers:a.headers,acceptedFiles:a.doc,autoProcessQueue:a.autoupload,parallelUploads:1e3,previewTemplate:i.uploadTmp,dictFileTooBig:"允许上传文件的最大限制为：{{maxFilesize}}MB",dictInvalidFileType:"上传的文件格式不被允许",dictResponseError:"上传文件失败，返回码：{{statusCode}}"}),i.upload.on("addedfile",function(){if(!a.autoupload){i.button.is(":hidden")&&(i.this.css("padding-bottom",50),i.button.show());var t=i.this.find(".dz-preview:not(.dz-complete)").length;i.button.find("em").html(t)}}).on("removedfile",function(){var t=i.this.find(".dz-preview:not(.dz-complete)").length;i.button.find("em").html(t),0==t&&(i.this.css("padding-bottom",10),i.button.hide())}).on("success",function(t,e){_.isFunction(a.success)&&a.success(e);var n=parseInt(i.button.find("em").html());i.button.find("em").html(n-1)}).on("error",function(t,e){Eadmin.message.error({content:e})}),box.on("click",".dz-upload-btn",function(){i.upload.processQueue()})}else console.log("请指定后端接收上传数据的API地址")}}]),t}();