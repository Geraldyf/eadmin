/*!
 eadmin极速后台UI框架（我只想要个后台） | @author:317953536@qq.com 
*/
"use strict";var _createClass=function(){function i(e,n){for(var o=0;o<n.length;o++){var i=n[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,n,o){return n&&i(e.prototype,n),o&&i(e,o),e}}();function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var box=void 0,eadmin=function(){function e(){var o=this;_classCallCheck(this,e),box=$("#container"),module.conf.allow_select_text||(selectText(0),selectEnabled=!1),module.conf.allow_right_click||disabledRight(),this.href="",this.boxScroll=null,this.jumpHref(),-1!=module.lib.indexOf("window")&&$(document).on("keyup",function(e){if(27==e.keyCode&&0!=$(".window:visible").length){o.maskHide();var n=$(".window:visible:first");n.removeClass("zoomIn").hide(),1==n.data("refresh")&&n.children(".body").empty()}}),-1!=module.lib.indexOf("notice")&&($("body").append('<div id="notice"></div>'),$("#notice").css("top",module.conf.notice_top))}return _createClass(e,[{key:"loading",value:function(){this.mask(),$(".mask").html('<i class="fa fa-spinner fa-pulse mr5"></i>页面加载中，请稍候...')}},{key:"loadingHide",value:function(){this.maskHide(),$(".mask").empty()}},{key:"mask",value:function(){0==$(".mask").length&&$("body").append('<div class="mask"></div>'),$(".mask").show()}},{key:"maskHide",value:function(){$(".mask").hide()}},{key:"homepage",value:function(){var e=this;box.height(innerH()-50-$("header").outerHeight()),null!=module.conf&&null!=module.conf.homepage&&""!=module.conf.homepage&&(this.loading(),null!=module.conf.load_page_timeout&&0<module.conf.load_page_timeout?setTimeout(function(){box.load(module.conf.homepage,function(){e.load()})},module.conf.load_page_timeout):box.load(module.conf.homepage,function(){e.load()}))}},{key:"jumpHref",value:function(){if(0==box.length)return console.log("没有找到id为container的容器div，请检查!"),!1;var o=this;$("body").on("click","a",function(){var e={this:$(this),subnav:$(".sub-nav")};if(o.href=e.this.attr("href"),e.this.hasClass("nav")){if(e.this.hasClass("active"))return!1;if(e.this.addClass("active").siblings().removeClass("active"),e.id=e.this.data("id"),e.sub=window.nav[e.id].sub,null==e.sub){if(null==window.nav[e.id].href)return console.log("当前分类既没有子分类，也没有指定链接"),!1;e.subnav.is(":hidden")||box.css("height","+=41"),e.subnav.hide()}else{for(var n in e.subnav.is(":hidden")&&box.css("height","-=41"),e.subnav.show(),e.navHtml="<ul>",e.sub)e.navHtml+='<a href="'+e.sub[n].href+'"',null!=e.sub[n].native?e.navHtml+=' data-native="1" target="_blank">':e.navHtml+=' class="nav-sub">',e.navHtml+="<li>",null!=e.sub[n].icon&&""!=e.sub[n].icon&&(e.navHtml+='<i class="fa fa-'+e.sub[n].icon+' mr5"></i>'),e.navHtml+=e.sub[n].name,e.navHtml+="</li></a>";if(e.navHtml+="</ul>",$(".sub-nav div").eq(1).html(e.navHtml),null!=module.conf.auto_click_sub_nav&&module.conf.auto_click_sub_nav)return null!=e.sub[0].native||e.subnav.find("a:first").trigger("click"),!1}}else if(e.this.hasClass("nav-sub")){if(e.this.hasClass("active"))return!1;e.subnav.find(".active").removeClass("active"),e.this.addClass("active")}if("javascript:;"!=o.href&&1!=e.this.data("native"))return o.refresh(!1),null!=module.conf.load_page_timeout&&0<module.conf.load_page_timeout?(box.empty(),setTimeout(function(){box.off().load(o.href,function(){o.load()})},module.conf.load_page_timeout)):box.empty().off().load(o.href,function(){o.load()}),!1})}},{key:"refresh",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],n=this;n.loading();var o=[".window",".datepicker",".citypicker"];for(var i in o)$(o[i]).off().remove();e&&setTimeout(function(){Method={},n.href=""==n.href?module.conf.homepage:n.href,box.empty().off().load(n.href,function(){n.load()})},module.conf.load_page_timeout)}},{key:"nav",value:function(){var n=function(e){var n="<ul>",o=0;for(var i in e){var t=0==o?" active":"";n+='<a href="'+(null==e[i].sub?e[i].href:"javascript:;")+'"',null==e[i].native?n+='class="nav'+t+'" data-id="'+i+'">':n+=' data-native="1" target="_blank">',n+="<li>"+e[i].name+"</li></a>",o++}n+="</ul>",$(".nav").html(n)};"local"!=module.conf.nav_data_source?""!=module.conf.nav_api_url?axios.get(module.conf.nav_api_url).then(function(e){window.nav=e.data,n(e.data)}).catch(function(e){console.log(e)}):console.log("导航接口地址不能为空，导航创建失败"):loader.load(_ROOTPATH+"data/nav.js",function(){n(window.nav)})}},{key:"load",value:function(){null!=this.boxScroll&&(this.boxScroll.destroy(),this.boxScroll=null),this.loadingHide(),this.form(),this.onscroll(),Button.run(box);var e=$("body").find(".iscroll");if(0<e.length){var n=this;e.each(function(){n.scroll($(this)[0])})}this.boxScroll=this.scroll(box[0])}},{key:"scroll",value:function(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"y",o={wheelPropagation:"y"!=n};return"y"==n?o.suppressScrollX=!0:o.suppressScrollY=!0,new PerfectScrollbar(e,o)}},{key:"form",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return Form.init(e),this}},{key:"datepicker",value:function(e,n){return new Datepikcer(e,n),this}},{key:"citypicker",value:function(e,n){return new Citypikcer(e,n),this}},{key:"window",value:function(e,n){var o=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];return new Window(e,n,o),this}},{key:"slider",value:function(e,n){return new Slider(e,n),this}},{key:"transfer",value:function(e,n){return new Transfer(e,n),this}},{key:"rate",value:function(e,n){return new Rate(e,n),this}},{key:"colorpicker",value:function(e,n){return new Colorpicker(e,n),this}},{key:"table",value:function(e,n){return new Table(e,n),this}},{key:"chart",value:function(e,n){return new EChart(e,n),this}},{key:"tree",value:function(e,n){return new Tree(e,n)}},{key:"template",value:function(o){function e(e,n){return o.apply(this,arguments)}return e.toString=function(){return o.toString()},e}(function(e,n){try{template;var o={html:template(e,n),box:$('[data-template="'+e+'"]')};if(0==o.box.length)return void console.log('没有找到对应的模版容器 data-template="'+e+'"，渲染失败');o.box.html(o.html)}catch(e){console.log(e)}})},{key:"resize",value:function(){$(window).on("resize",_.debounce(function(){innerW()},200))}},{key:"onscroll",value:function(){var n=[".datepicker",".citypicker"];box.on("scroll",function(){if(clear){for(var e in n)$(n[e]).hide();$(":focus").blur(),clear=!1}})}}]),e}(),Eadmin=new eadmin;loader.ready(function(){null!=module.framework.chart&&(Chart.defaults.fontColor="#FFF",Chart.defaults.scale.gridLines.color="#151935"),null!=module.framework.axios&&_.each(module.conf.http,function(e,n){axios.defaults[n]=e}),-1!=module.plugin.indexOf("dropzone")&&(Dropzone.autoDiscover=!1),Eadmin.nav(),Eadmin.homepage(),Eadmin.resize(),-1!=module.lib.indexOf("tips")&&(Eadmin.tips=Tips),-1!=module.lib.indexOf("upload")&&(Eadmin.upload=Upload),-1!=module.lib.indexOf("popup")&&(Eadmin.popup=Popup),-1!=module.lib.indexOf("message")&&(Eadmin.message=Message),-1!=module.lib.indexOf("notice")&&(Eadmin.notice=Notice),-1!=module.lib.indexOf("button")&&(Eadmin.button=Button,Button.event()),-1!=module.lib.indexOf("form")&&Form.event(),-1!=module.lib.indexOf("validate")&&Validate.run(),-1!=module.lib.indexOf("tips")&&Tips.run()});